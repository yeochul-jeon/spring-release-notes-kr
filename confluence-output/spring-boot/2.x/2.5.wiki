h1. Spring Boot 2.5 릴리즈 노트

{quote}
출시일: 2021-05 | Java 최소 버전: 8 | [공식 릴리즈 노트|https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.5-Release-Notes]
{quote}

h2. 개요

Spring Boot 2.5는 *Spring Framework 5.3* 기반을 유지하면서, SQL 스크립트 초기화 방식을 전면 재설계하고
Java 16 및 Gradle 7을 공식 지원하는 버전입니다. 환경 변수 접두사(Environment Variable Prefix) 기능,
HTTP/2 over TCP(h2c) 지원, 그리고 MongoDB/Quartz 메트릭 등 관찰 가능성(Observability) 강화가 주요 특징입니다.

----

h2. 플랫폼 요구사항

|| 항목 || 요구 버전 ||
| *Java* | 8 이상 (Java 16까지 지원) |
| *Spring Framework* | 5.3 |
| *Gradle* | 6.8+ (Gradle 7 지원) |
| *Maven* | 3.3+ |
| *Tomcat* | 9.0 |
| *Jetty* | 9.4 (Jetty 10 선택 가능, Java 11 필요) |
| *Undertow* | 2.2 |

----

h2. 주요 변경사항

h3. 1. SQL 스크립트 초기화 방식 재설계

{{schema.sql}}과 {{data.sql}}을 이용한 데이터베이스 초기화 메커니즘이 *전면 재설계*되었습니다.

|| 이전 (Deprecated) || 변경 후 ||
| {{spring.datasource.initialization\-mode}} | {{spring.sql.init.mode}} |
| {{spring.datasource.schema}} | {{spring.sql.init.schema\-locations}} |
| {{spring.datasource.data}} | {{spring.sql.init.data\-locations}} |
| {{spring.datasource.platform}} | {{spring.sql.init.platform}} |

{code:language=properties|theme=Emacs}
# 인메모리 DB가 아닌 경우 SQL 초기화를 활성화하려면 직접 지정
spring.sql.init.mode=always

# data.sql이 Hibernate 초기화 이후에 실행되도록 설정
spring.jpa.defer-datasource-initialization=true
{code}

* 기본적으로 *인메모리 DB에서만* SQL 초기화가 실행됩니다.
* \{\{data.sql\}\}은 이제 Hibernate 초기화 *이전에* 실행됩니다 (Flyway/Liquibase와 동일한 순서).
* 새 프로퍼티는 JDBC와 R2DBC 모두에서 동작합니다.

h3. 2. Spring Data JPA {{getById}} 메서드 변경

Spring Data JPA에 새로운 {{getById}} 메서드가 추가되어 기존 {{getOne}}을 대체합니다. 기존에 리포지토리에 {{getById}}라는 이름의 커스텀 메서드가 있으면 {{LazyLoadingException}}이 발생할 수 있으므로 {{getUserById}} 등으로 이름을 변경하세요.

h3. 3. Actuator {{/info}} 엔드포인트 보안 강화

{{/info}} 엔드포인트가 더 이상 웹으로 기본 노출되지 않습니다. Spring Security가 클래스패스에 있으면 인증이 필요합니다.

{code:language=properties|theme=Emacs}
# 이전처럼 노출하려면 직접 설정 필요
management.endpoints.web.exposure.include=health,info
{code}

h3. 4. Spring Integration TaskScheduler 공유

Spring Integration이 자동 설정된 {{TaskScheduler}}를 재사용하여 기본 스레드 풀이 1로 줄어듭니다. 이전 기본값(10)으로 복원하려면 {{spring.task.scheduling.pool.size=10}}을 설정하세요.

h3. 5. 기타 주요 변경

* *Gradle jar/war 태스크:* 표준 태스크를 비활성화하지 않고 분류자(classifier) 적용으로 변경
* *로깅 종료 훅:* JAR 애플리케이션에서 기본 등록 (\{\{logging.register\-shutdown\-hook=false\}\}로 비활성화)
* *에러 응답 message 필드:* 빈 문자열 대신 필드 자체가 생략됨
* *Flyway/Liquibase JDBC URL:* \{\{spring.flyway.url\}\} 설정 시 \{\{username\}\}/\{\{password\}\}도 별도 지정 필요
* *EL 구현체:* Glassfish에서 Tomcat 구현체(\{\{tomcat\-embed\-el\}\})로 변경
* *Groovy 3:* 기본 버전이 3.x로 업그레이드 (Spock 사용 시 2.0으로 업그레이드 필요)

----

h2. 새로운 기능

h3. 환경 변수 접두사 (Environment Variable Prefix)

동일 환경에서 여러 Spring Boot 애플리케이션을 실행할 때, 환경 변수에 접두사를 지정할 수 있습니다.

{code:language=java|theme=Emacs}
// 메인 클래스에서 접두사 설정
public static void main(String[] args) {
    SpringApplication application = new SpringApplication(MyApp.class);
    application.setEnvironmentPrefix("myapp");  // 접두사 설정
    application.run(args);
}
// 이후 MYAPP_SERVER_PORT=8080 같은 형태로 환경 변수 사용
{code}

h3. HTTP/2 over TCP (h2c) 지원

4가지 내장 웹 서버 모두에서 SSL 없이 HTTP/2를 사용할 수 있습니다.

{code:language=properties|theme=Emacs}
# SSL 없이 HTTP/2 활성화 (h2c)
server.http2.enabled=true
{code}

h3. Docker 이미지 빌드 개선

{code:language=text|title=mermaid|collapse=true|theme=Emacs}
graph TB
    SB25["Spring Boot 2.5 Docker 지원"]
    LWAR["레이어드 WAR 지원"]
    CUSTOM["커스텀 Buildpack 지정"]
    BIND["볼륨 바인딩 지원"]
    WAR["WAR → Docker 이미지"]

    SB25 --> LWAR
    SB25 --> CUSTOM
    SB25 --> BIND
    SB25 --> WAR

    style SB25 fill:#4CAF50,color:#fff
    style LWAR fill:#FF9800,color:#fff
{code}

h3. 메트릭 개선

|| 항목 || 설명 ||
| *Spring Data Repository* | {{spring.data.repository.invocations}} 이름으로 자동 생성 |
| *MongoDB* | 커넥션 풀 및 클라이언트 명령 메트릭 자동 수집 |
| *WebFlux {{@Timed}}* | WebFlux 컨트롤러에서도 수동 타이밍 가능 |
| *OpenMetrics* | {{/actuator/prometheus}}에서 OpenMetrics 형식 지원 |

h3. Quartz Actuator 엔드포인트

Quartz 스케줄러의 작업(Job)과 트리거(Trigger) 정보를 {{GET /actuator/quartz}}로 확인할 수 있습니다.

h3. R2DBC 데이터베이스 초기화

리액티브 DB 접근용 R2DBC에서도 {{schema.sql}}/{{data.sql}} 기반 초기화가 지원됩니다.

h3. Java 16 및 Gradle 7 지원

* *Java 16:* 공식 지원 및 테스트 완료 (최소 버전은 Java 8 유지)
* *Gradle 7:* Spring Boot Gradle 플러그인이 Gradle 7.0.x를 공식 지원

h3. Jetty 10 지원

Jetty 10을 내장 웹 서버로 선택 가능합니다 (Java 11 필요, 기본값은 Jetty 9 유지).

h3. Startup 엔드포인트 GET 요청 지원

기존 POST 방식에 추가로 GET 요청을 지원합니다. GET은 이벤트 버퍼를 비우지 않으므로 반복 조회가 가능합니다.

h3. 기타 새 기능

* \{\{management.endpoints.web.cors.allowed\-origin\-patterns\}\} 프로퍼티 추가
* Elasticsearch \{\{Sniffer\}\} 자동 설정
* \{\{DataSourceBuilder.derivedFrom(...)\}\} 으로 기존 DataSource 기반 새 DataSource 생성
* Azure App Service 자동 감지, Apache HttpClient 5 WebClient 자동 설정
* Tomcat \{\{keep\-alive\-timeout\}\} 및 \{\{max\-keep\-alive\-requests\}\} 설정 프로퍼티 추가
* WebFlux SameSite 쿠키 정책 설정 (\{\{spring.webflux.session.cookie.same\-site\}\})

----

h2. 주요 의존성 업그레이드

{code:language=text|title=mermaid|collapse=true|theme=Emacs}
graph TB
    SB25["Spring Boot 2.5"]

    subgraph "핵심"
        SF53["Spring Framework 5.3"]
        SS55["Spring Security 5.5"]
        SD["Spring Data 2021.0"]
    end

    subgraph "언어/빌드"
        KOTLIN["Kotlin 1.5"]
        GROOVY["Groovy 3.0"]
    end

    subgraph "인프라"
        JACKSON["Jackson 2.12"]
        ES["Elasticsearch 7.12"]
        FLYWAY["Flyway 7.7"]
    end

    SB25 --> SF53
    SB25 --> SS55
    SB25 --> SD
    SB25 --> KOTLIN
    SB25 --> JACKSON
    SB25 --> ES
    SB25 --> FLYWAY

    style SB25 fill:#4CAF50,color:#fff
    style SF53 fill:#2196F3,color:#fff
    style SS55 fill:#2196F3,color:#fff
{code}

<details>
<summary>전체 의존성 목록 펼치기</summary>

|| 프로젝트 || 버전 ||
| Spring Framework | 5.3 |
| Spring Security | 5.5 |
| Spring Data | 2021.0 |
| Spring Integration | 5.5 |
| Spring HATEOAS | 1.3 |
| Spring Kafka | 2.7 |
| Spring Session | 2021.0 |
| Kotlin | 1.5 |
| Groovy | 3.0 |
| Jackson | 2.12 |
| Flyway | 7.7 |
| Liquibase | 4.3 |
| Elasticsearch | 7.12 |
| Hibernate Validator | 6.2 |
| Cassandra Driver | 4.10 |
| MongoDB Driver | 4.2 |
| JUnit Jupiter | 5.7 |
| Mockito | 3.7 |

</details>

----

h2. Deprecated 및 제거 항목

h3. Deprecated

|| 항목 || 대체 방법 ||
| {{ActuatorMediaType}}, {{ApiVersion}} (endpoint.http 패키지) | {{endpoint}} 패키지의 동일 클래스 사용 |
| jOOQ {{\*Provider}} 빈, {{Settings}} 빈 | {{DefaultConfigurationCustomizer}} 사용 |
| {{EntityManagerFactoryDependsOnPostProcessor}} (data.jpa) | {{orm.jpa}} 패키지 클래스 사용 |
| {{spring.artemis.host}} / {{spring.artemis.port}} | {{spring.artemis.broker\-url}} 사용 |
| {{spring.datasource.\*}} (초기화 관련) | {{spring.sql.init.\*}} 사용 |

h3. 제거

* Spring Boot 2.3에서 Deprecated된 코드 *제거*
* *Spring Data Solr* 자동 설정 제거 (Spring Data 2021.0에서 Solr 모듈 제거)

----

h2. 호환성

{code:language=text|title=mermaid|collapse=true|theme=Emacs}
graph LR
    subgraph "필수"
        JAVA["Java 8 ~ 16"]
        SF["Spring Framework 5.3"]
    end

    subgraph "서블릿 컨테이너"
        TOMCAT["Tomcat 9.0"]
        JETTY9["Jetty 9.4 (기본)"]
        JETTY10["Jetty 10 (선택, Java 11+)"]
        UNDERTOW["Undertow 2.2"]
    end

    subgraph "빌드 도구"
        GRADLE["Gradle 6.8+ / 7.x"]
        MAVEN["Maven 3.3+"]
    end

    SB25["Spring Boot 2.5"] --> JAVA
    SB25 --> SF
    SB25 --> TOMCAT
    SB25 --> JETTY9
    SB25 --> JETTY10
    SB25 --> UNDERTOW
    SB25 --> GRADLE
    SB25 --> MAVEN

    style SB25 fill:#4CAF50,color:#fff
    style SF fill:#2196F3,color:#fff
    style JETTY10 fill:#FF9800,color:#fff
{code}

----

h2. 참고 자료

* [Spring Boot 2.5 공식 릴리즈 노트|https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.5-Release-Notes]
* [Spring Boot 2.5 Configuration Changelog|https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.5-Configuration-Changelog]
* [Spring Framework 5.3|../../spring-framework/5.x/5.3.md]
* [Spring Boot 2.4 릴리즈 노트|2.4.md]
