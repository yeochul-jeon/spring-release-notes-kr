h1. Spring Boot 3.0 릴리즈 노트

{quote}
출시일: 2022-11 | Java 최소 버전: 17 | [공식 릴리즈 노트|https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Release-Notes]
{quote}

h2. 개요

Spring Boot 3.0은 *Jakarta EE 9+* 전환과 *GraalVM 네이티브 이미지* 공식 지원을 핵심으로 하는 메이저 버전입니다.
최소 Java 버전이 17로 상향되었고, *Spring Framework 6.0*을 기반으로 합니다.
Micrometer Observation API를 통해 메트릭(Metrics)과 트레이싱(Tracing)을 하나의 API로 통합하는 등
관찰 가능성(Observability) 영역이 크게 개선되었습니다.

{quote}
*업그레이드 전 필수 사항:* Spring Boot 2.7.x 최신 버전으로 먼저 업그레이드하고,
모든 Deprecated 경고를 해결한 후 3.0으로 전환하세요.
[2.x → 3.x 마이그레이션 가이드|../../migration-guides/spring-boot-2to3.md]를 참고하세요.
{quote}

----

h2. 플랫폼 요구사항

|| 항목 || 요구 버전 ||
| *Java* | 17 이상 (JDK 19까지 테스트 완료) |
| *Spring Framework* | 6.0 |
| *Jakarta EE* | 9+ (Jakarta EE 10 호환) |
| *Servlet* | 6.0 (Tomcat 10, Jetty 11) |
| *Gradle* | 7.5 이상 |
| *Maven* | 3.5 이상 |
| *GraalVM* | 22.3 이상 (네이티브 이미지 사용 시) |
| *Native Build Tools* | 0.9.17 이상 |

----

h2. 주요 변경사항

h3. 1. Jakarta EE 전환 ({{javax.*}} → {{jakarta.*}})

Spring Boot 3.0의 가장 큰 변화입니다. 기존 {{javax.*}} 패키지가 모두 {{jakarta.*}}로 변경되었습니다.
프로젝트의 *모든 import 문*을 수정해야 합니다.

{code:language=java}
// 변경 전 (Spring Boot 2.x)
import javax.persistence.Entity;
import javax.servlet.http.HttpServletRequest;
import javax.validation.constraints.NotNull;

// 변경 후 (Spring Boot 3.0)
import jakarta.persistence.Entity;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.validation.constraints.NotNull;
{code}

주요 Jakarta EE 10 호환 버전:

|| Jakarta API || 버전 ||
| Jakarta Servlet | 6.0 |
| Jakarta Persistence | 3.1 |
| Jakarta Validation | 3.0 |
| Jakarta Mail | 2.1 |
| Jakarta JMS | 3.1 |
| Jakarta WebSocket | 2.1 |
| Jakarta Transaction | 2.0 |

{quote}
*팁:* [OpenRewrite|https://docs.openrewrite.org/] 자동 마이그레이션 도구를 활용하면
{{javax}} → {{jakarta}} 변환을 자동으로 처리할 수 있습니다.
{quote}

h3. 2. 주요 의존성 업그레이드

{code:language=text|title=mermaid|collapse=true}
graph TB
    SB3["Spring Boot 3.0"]

    subgraph "핵심 프레임워크"
        SF6["Spring Framework 6.0"]
        SS6["Spring Security 6.0"]
    end

    subgraph "데이터"
        SD["Spring Data 2022.0"]
        SB5["Spring Batch 5.0"]
        HIB["Hibernate 6.1"]
    end

    subgraph "기타"
        MM["Micrometer 1.10"]
        JACKSON["Jackson 2.14"]
        KOTLIN["Kotlin 1.7.20"]
        SAMQP["Spring AMQP 3.0"]
    end

    SB3 --> SF6
    SB3 --> SS6
    SB3 --> SD
    SB3 --> SB5
    SB3 --> HIB
    SB3 --> MM
    SB3 --> JACKSON
    SB3 --> KOTLIN
    SB3 --> SAMQP

    style SB3 fill:#4CAF50,color:#fff
    style SF6 fill:#2196F3,color:#fff
    style SS6 fill:#2196F3,color:#fff
{code}

h3. 3. {{@ConstructorBinding}} 변경

생성자가 하나뿐인 {{@ConfigurationProperties}} 클래스에서는 더 이상 {{@ConstructorBinding}}을 붙이지 않아도 됩니다.

{code:language=java}
// Spring Boot 3.0 — 단일 생성자면 어노테이션 불필요
@ConfigurationProperties(prefix = "app")
public record AppProperties(String name, int port) {
    // @ConstructorBinding 없이 자동으로 생성자 바인딩 적용
}
{code}

생성자가 여러 개인 경우에만 바인딩할 생성자에 {{@ConstructorBinding}}을 붙입니다.
단, 패키지가 {{org.springframework.boot.context.properties.bind}}로 이동되었습니다.

----

h2. 새로운 기능

h3. 1. GraalVM 네이티브 이미지 공식 지원

Spring Boot 애플리케이션을 GraalVM 네이티브 이미지로 컴파일할 수 있습니다.
네이티브 이미지는 *시작 시간*과 *메모리 사용량*을 크게 줄여줍니다.

{code:language=bash}
# Maven으로 네이티브 이미지 빌드
./mvnw -Pnative native:compile

# Gradle로 네이티브 이미지 빌드
./gradlew nativeCompile
{code}

{quote}
네이티브 이미지는 AOT(Ahead-of-Time) 컴파일 방식으로,
애플리케이션을 미리 기계어로 변환하여 JVM 없이 실행할 수 있게 합니다.
{quote}

h3. 2. Micrometer Observation API (관찰 가능성 통합)

메트릭(수치 측정)과 트레이싱(요청 추적)을 *하나의 API*로 통합했습니다.
{{ObservationRegistry}}가 자동 설정되며, 하나의 {{Observation}}으로 타이머와 트레이스를 동시에 생성합니다.

{code:language=java}
@Component
@RequiredArgsConstructor
public class MyService {

    private final ObservationRegistry observationRegistry;

    public void doSomething() {
        // 하나의 Observation으로 메트릭 + 트레이싱 동시 처리
        Observation.createNotStarted("my.operation", observationRegistry)
            .observe(() -> {
                // 비즈니스 로직
            });
    }
}
{code}

지원하는 트레이싱 시스템:

* **Brave** (Zipkin)
* **OpenTelemetry**
* **Wavefront**

설정 프로퍼티: {{management.tracing.*}}, {{management.zipkin.tracing.*}}

h3. 3. OTLP Meter Registry 자동 설정

{{micrometer-registry-otlp}}가 클래스패스에 있으면 {{OtlpMeterRegistry}}가 자동 설정됩니다.
{{management.otlp.metrics.export.*}} 프로퍼티로 구성합니다.

h3. 4. Log4j2 개선

* **프로필별 설정**: Spring 프로필에 따라 Log4j2 설정을 분기할 수 있습니다.
* **환경 변수 조회**: Log4j2 설정 파일에서 Spring 환경 프로퍼티를 참조할 수 있습니다.
* **JUL 라우팅 개선**: `Log4jBridgeHandler`를 사용하여 JUL(Java Util Logging)을 SLF4J 대신 Log4j2로 직접 라우팅합니다.

h3. 5. Elasticsearch Java Client 자동 설정

공식 Elasticsearch Java Client에 대한 자동 설정이 추가되었습니다.
{{spring.elasticsearch.*}} 프로퍼티로 구성합니다.

h3. 6. {{@SpringBootTest}} 개선

테스트에서 {{@SpringBootConfiguration}} 클래스의 {{main()}} 메서드를 활용할 수 있습니다.

{code:language=java}
@SpringBootTest(useMainMethod = UseMainMethod.ALWAYS)
class MyApplicationTests {
    // main() 메서드를 사용하여 애플리케이션 컨텍스트 시작
}
{code}

h3. 7. Spring Data JDBC 유연성 향상

자동 설정된 빈들을 교체할 수 있게 되었습니다:
{{JdbcAggregateTemplate}}, {{DataAccessStrategy}}, {{JdbcConverter}}, {{JdbcCustomConversions}},
{{JdbcMappingContext}}, {{Dialect}} 등

----

h2. 개선사항

* **시작 로그 간소화**: 호스트 이름(hostname)이 더 이상 시작 시 로깅되지 않아 시작 성능이 향상됩니다.
* **Bean Validation 커스터마이징**: `ValidationConfigurationCustomizer` 빈으로 Validation `Configuration`을 커스터마이징할 수 있습니다.
* **JdkClientHttpConnector 자동 설정**: Reactor Netty, Jetty, Apache 클라이언트가 없을 때 JDK 내장 HTTP 클라이언트를 자동으로 사용합니다.
* **MongoDB 다중 호스트**: `spring.data.mongodb.additional-hosts`로 여러 호스트를 설정할 수 있습니다.
* **Kafka 비동기 확인**: `spring.kafka.listener.async-acks` 프로퍼티가 추가되었습니다.
* **Tomcat 신뢰 프록시**: `server.tomcat.remoteip.trusted-proxies` 프로퍼티가 추가되었습니다.

----

h2. Deprecated 및 제거 항목

h3. 제거된 항목

|| 항목 || 사유 ||
| {{SecurityManager}} 지원 | JDK에서 Deprecated됨 |
| {{CommonsMultipartResolver}} | Spring Framework 6에서 제거됨 |
| Cookie {{comment}} 프로퍼티 | 더 이상 지원되지 않음 |

h3. Deprecated 항목

|| 기존 || 대체 ||
| {{@ConstructorBinding}} (기존 패키지) | {{o.s.b.context.properties.bind}} 패키지로 이동 |
| {{ClientHttpRequestFactorySupplier}} | {{ClientHttpRequestFactories}} |
| {{RestTemplateExchangeTagsProvider}} 등 | {{ObservationConvention}} 기반 클래스 |
| {{@AutoConfigureMetrics}} | {{@AutoConfigureObservability}} |
| {{management.metrics.export.<제품>}} | {{management.<제품>.metrics.export}} |
| Push Gateway {{push}} 설정 | {{post}}로 변경 |

----

h2. 호환성

{code:language=text|title=mermaid|collapse=true}
graph LR
    subgraph "필수 환경"
        JAVA["Java 17+"]
        SF["Spring Framework 6.0"]
        JEE["Jakarta EE 9+"]
        SERVLET["Servlet 6.0"]
    end

    subgraph "서블릿 컨테이너"
        TOMCAT["Tomcat 10"]
        JETTY["Jetty 11"]
        UNDERTOW["Undertow 2.2"]
    end

    subgraph "빌드 도구"
        GRADLE["Gradle 7.5+"]
        MAVEN["Maven 3.5+"]
    end

    SB3["Spring Boot 3.0"] --> JAVA
    SB3 --> SF
    SB3 --> JEE
    SB3 --> SERVLET
    SB3 --> TOMCAT
    SB3 --> JETTY
    SB3 --> UNDERTOW
    SB3 --> GRADLE
    SB3 --> MAVEN

    style SB3 fill:#4CAF50,color:#fff
    style JEE fill:#FF9800,color:#fff
{code}

----

h2. 참고 자료

* [Spring Boot 3.0 공식 릴리즈 노트](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Release-Notes)
* [Spring Boot 3.0 마이그레이션 가이드](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide)
* [Spring Framework 6.0](../../spring-framework/6.x/6.0.md)
* [2.x → 3.x 마이그레이션 가이드](../../migration-guides/spring-boot-2to3.md)
* [OpenRewrite Spring Boot 3 마이그레이션 레시피](https://docs.openrewrite.org/recipes/java/spring/boot3/upgradespringboot_3_0)
* [GraalVM 네이티브 이미지 가이드](https://docs.spring.io/spring-boot/docs/3.0.x/reference/html/native-image.html)
