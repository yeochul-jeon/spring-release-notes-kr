h1. Spring Boot 3.3 릴리즈 노트

{quote}
출시일: 2024-05 | Java 최소 버전: 17 | [공식 릴리즈 노트|https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.3-Release-Notes]
{quote}

h2. 개요

Spring Boot 3.3은 *Spring Framework 6.1*을 기반으로, *CDS(Class Data Sharing)* 를 통한 애플리케이션 시작 시간 단축,
*Base64 리소스 로딩*, *SBOM(소프트웨어 자재 명세서) Actuator 엔드포인트*, *SNI(Server Name Indication) 기반 다중 호스트 SSL* 등
운영 환경의 성능과 보안을 강화한 버전입니다.
또한 *서비스 연결(Service Connection)* 이 대폭 확장되어 더 많은 외부 서비스를 손쉽게 연동할 수 있습니다.

----

h2. 플랫폼 요구사항

|| 항목 || 요구 버전 ||
| *Java* | 17 이상 (가상 스레드는 Java 21 필요) |
| *Spring Framework* | [6.1|../../spring-framework/6.x/6.1.md] |
| *Jakarta EE* | 9+ (Servlet 5.0+) |
| *Gradle* | 7.5+ 또는 8.x (네이티브: Native Build Tools 0.10.x+) |
| *Maven* | 3.6+ |

----

h2. 주요 변경사항

h3. 1. Prometheus 클라이언트 1.x 업그레이드

Prometheus Client가 0.x에서 *1.x*로 업그레이드되었습니다.
메트릭 이름 규칙이 변경되었으므로, 대시보드나 알림 규칙을 확인해야 합니다.

{code:language=groovy}
// 기존 0.x 버전을 계속 사용해야 하는 경우
dependencies {
    implementation 'io.micrometer:micrometer-registry-prometheus-simpleclient'
}
{code}

{quote}
*주의:* Push Gateway 지원은 1.x에서 아직 제공되지 않습니다.
{quote}

h3. 2. Flyway 10 모듈화 구조 변경

Flyway 10부터 데이터베이스별로 *별도 모듈*이 필요합니다.
기존에는 {{flyway-core}}만으로 충분했지만, 이제 사용하는 DB에 맞는 의존성을 추가해야 합니다.

{code:language=groovy}
// build.gradle - 사용하는 데이터베이스에 맞는 Flyway 모듈 추가
dependencies {
    implementation 'org.flywaydb:flyway-database-postgresql' // PostgreSQL
    // 또는
    implementation 'org.flywaydb:flyway-database-mysql'      // MySQL
}
{code}

h3. 3. Jersey 관찰 가능성 변경

Jersey를 사용하는 경우 {{org.glassfish.jersey.ext:jersey-micrometer}} 의존성을 추가해야 합니다.
기존 {{JerseyTagsProvider}}를 사용하던 커스텀 태그 설정은 {{JerseyObservationConvention}}으로 마이그레이션해야 합니다.

h3. 4. Infinispan 15 Jakarta EE 전환

Infinispan 15에서 {{-jakarta}} 접미사 모듈이 제거되었습니다.
예: {{infinispan-core-jakarta}} -> {{infinispan-core}}로 의존성을 변경하세요.

h3. 5. Git Commit ID 날짜 형식 변경

재현 가능한 빌드(reproducible builds)를 위해 Git Commit ID Maven 플러그인의 날짜 형식이 변경되었습니다:
{{yyyy-MM-dd'T'HH:mm:ssXXX}}

----

h2. 새로운 기능

h3. 1. CDS(Class Data Sharing) 지원

CDS는 JVM이 클래스 메타데이터를 사전에 공유 아카이브로 저장하여 *시작 시간을 단축하고 메모리 사용량을 줄이는* 기술입니다.
Spring Boot 3.3에서는 {{tools}} jarmode를 통해 CDS 친화적인 레이아웃을 쉽게 생성할 수 있습니다.

{code:language=bash}
# 1단계: uber JAR 추출
java -Djarmode=tools -jar my-app.jar extract

# 2단계: CDS 아카이브 생성 후 실행
cd my-app
java -XX:SharedArchiveFile=app.jsa -jar my-app.jar
{code}

{code:language=text|title=mermaid|collapse=true}
graph LR
    JAR["Uber JAR"] -->|"jarmode=tools\nextract"| EXTRACT["추출된 앱"]
    EXTRACT -->|"CDS 아카이브\n생성"| CDS["CDS 캐시\n(.jsa 파일)"]
    CDS -->|"빠른 시작"| APP["애플리케이션\n실행"]

    style JAR fill:#FF9800,color:#fff
    style CDS fill:#4CAF50,color:#fff
    style APP fill:#2196F3,color:#fff
{code}

h3. 2. SBOM Actuator 엔드포인트

SBOM(Software Bill of Materials, 소프트웨어 자재 명세서)은 애플리케이션에 포함된 모든 라이브러리와 버전을 목록화한 문서입니다.
새로운 Actuator 엔드포인트를 통해 애플리케이션의 SBOM 정보를 조회할 수 있습니다.

지원 형식:

* `META-INF/sbom/bom.json` (CycloneDX)
* `META-INF/sbom/application.cdx.json`

h3. 3. Base64 리소스 로딩

{{base64:}} 접두사를 사용하여 Base64로 인코딩된 값을 리소스로 로딩할 수 있습니다.
SSL 인증서를 환경 변수로 전달할 때 특히 유용합니다.

{code:language=yaml}
# application.yml - Base64로 인코딩된 인증서를 직접 설정
spring:
  ssl:
    bundle:
      pem:
        my-cert:
          keystore:
            certificate: "base64:LS0tLS1CRUdJTi..."  # Base64 인코딩된 인증서
{code}

h3. 4. SNI 기반 다중 호스트 SSL

하나의 서버에서 *여러 호스트 이름에 각각 다른 SSL 인증서*를 적용할 수 있습니다.
SNI(Server Name Indication)는 클라이언트가 접속하려는 호스트 이름을 서버에 알려주는 TLS 확장 기능입니다.
Tomcat, Netty, Undertow에서 지원됩니다.

h3. 5. 서비스 연결(Service Connection) 확장

Docker Compose와 Testcontainers를 통한 서비스 연결이 대폭 확장되었습니다.

|| 새로 지원되는 서비스 || 설명 ||
| Apache ActiveMQ Artemis | 메시징 브로커 |
| ActiveMQ Classic | 레거시 메시징 브로커 (공식 Docker 이미지) |
| LDAP | {{osixia/openldap}} 컨테이너 지원 |
| *Bitnami 이미지* | Cassandra, Elasticsearch, MariaDB, MySQL, MongoDB, Neo4j, PostgreSQL, RabbitMQ, Redis |

{quote}
*Bitnami 이미지란?* VMware에서 제공하는 사전 구성된 컨테이너 이미지로, 프로덕션 환경에 최적화되어 있습니다.
{quote}

h3. 6. Spring Security 자동 구성 개선

JWT 인증 관련 속성을 설정하면 {{JwtAuthenticationConverter}}가 자동 구성됩니다:

{code:language=yaml}
# application.yml - JWT 인증 자동 구성
spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          authority-prefix: "ROLE_"           # 권한 접두사
          principal-claim-name: "sub"          # 주체 클레임 이름
          authorities-claim-names: "roles"     # 권한 클레임 이름
{code}

----

h2. 개선사항

h3. 관찰 가능성(Observability)

* **Micrometer `@SpanTag` 어노테이션 지원:** 트레이스 스팬에 태그를 선언적으로 추가 가능
* Brave와 OpenTelemetry 모두에서 태그 필드 지원
* 프로세스 정보 제공: `management.info.process.enabled=true`로 활성화
* OpenTelemetry에서 `spring.application.name` 미설정 시 기본값 `unknown_service` 사용
* Apache Pulsar 관찰 가능성 기본값이 `true`에서 `false`로 변경 (일관성을 위해)

h3. Docker Compose 지원 개선

더 많은 서비스에 대한 Docker Compose 자동 연결을 지원하며,
Bitnami 컨테이너 이미지와의 호환성이 추가되었습니다.

h3. WebSocket 가상 스레드 지원

{{AsyncTaskExecutor}} 빈이 WebSocket {{ChannelRegistration}}에 자동 등록되어,
가상 스레드 환경에서 WebSocket 통신이 가능합니다.

h3. 빌드 및 문서 개선

* Windows 환경에서 대량 의존성 사용 시 발생하던 **클래스패스 길이 문제** 해결
* 공식 문서가 **Antora** 기반으로 마이그레이션되어 검색 기능 향상
* `spring.data.jdbc.dialect` 속성으로 Spring Data JDBC 방언(dialect) 설정 가능

----

h2. Deprecated 및 제거 항목

h3. Deprecated (향후 제거 예정)

|| 항목 || 대체 ||
| {{ZipkinRestTemplateBuilderCustomizer}} | {{ZipkinHttpClientBuilderCustomizer}} |
| {{ZipkinWebClientBuilderCustomizer}} | {{ZipkinHttpClientBuilderCustomizer}} |
| {{-Djarmode=layertools extract}} | {{-Djarmode=tools extract --layers}} |
| {{@ServletEndpoint}} | {{@Endpoint}} 모델 사용 |
| {{@ControllerEndpoint}} | {{@Endpoint}} 모델 사용 |
| {{@RestControllerEndpoint}} | {{@Endpoint}} 모델 사용 |

{quote}
{{@ServletEndpoint}}, {{@ControllerEndpoint}}, {{@RestControllerEndpoint}}는 Actuator 엔드포인트를
서블릿이나 컨트롤러 방식으로 정의하는 어노테이션이었으나, 표준 {{@Endpoint}} 모델로 통합됩니다.
{quote}

----

h2. 호환성

{code:language=text|title=mermaid|collapse=true}
graph LR
    subgraph "필수 환경"
        JAVA["Java 17+\n(가상 스레드: 21+)"]
        SF["Spring Framework 6.1"]
        JEE["Jakarta EE 9+"]
    end

    subgraph "서블릿 컨테이너"
        TOMCAT["Tomcat 10.1"]
        JETTY["Jetty 12"]
    end

    subgraph "주요 의존성"
        HIB["Hibernate 6.5"]
        MM["Micrometer 1.13"]
        PROM["Prometheus Client 1.x"]
    end

    SB33["Spring Boot 3.3"] --> JAVA
    SB33 --> SF
    SB33 --> JEE
    SB33 --> TOMCAT
    SB33 --> JETTY
    SB33 --> HIB
    SB33 --> MM
    SB33 --> PROM

    style SB33 fill:#4CAF50,color:#fff
    style SF fill:#2196F3,color:#fff
    style PROM fill:#FF9800,color:#fff
{code}

<details>
<summary>주요 의존성 버전 목록 펼치기</summary>

|| 프로젝트 || 버전 ||
| Spring Framework | 6.1 |
| Spring Security | 6.3 |
| Spring Data | 2024.0 |
| Micrometer | 1.13 |
| Micrometer Tracing | 1.3 |
| Hibernate | 6.5 |
| Jackson | 2.17 |
| Brave | 6.0 |
| Zipkin | 3.0 |
| OpenTelemetry | 1.37 |

</details>

----

h2. 참고 자료

* [Spring Boot 3.3 공식 릴리즈 노트](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.3-Release-Notes)
* [Spring Boot 3.2 릴리즈 노트](3.2.md) (이전 버전)
* [Spring Framework 6.1 릴리즈 노트](../../spring-framework/6.x/6.1.md)
* [Spring Boot 3.x 시리즈 개요](README.md)
* [3.x -> 4.x 마이그레이션 가이드](../../migration-guides/spring-boot-3to4.md)
